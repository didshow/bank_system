## 前提条件

要运行测试,您需要以下工具:

- [Node.js](https://nodejs.org/) (测试 node 版本： v20.9.0)
- [Hardhat](https://hardhat.org/) (测试 Hardhar 版本： 2.22.4)
- [Chai](https://www.chaijs.com/) (测试 Chai 版本： 4.3.7)

您可以在项目根目录运行以下命令安装所需依赖:

```
npm install
```

## 运行测试

要运行测试套件,请使用以下命令:

```
npx hardhat test
```

这将执行 `test` 目录中定义的所有测试用例。

## Star 合约测试

`Star.mjs`包含了 `Star` 合约的测试用例。`Star` 合约是一个继承 ERC20 的 TOKEN 合约。

### 目录

- [概述]
- [测试用例]

### 概述

`Star` 合约是一个继承 ERC20 的 TOKEN 合约，是本实验的测试代币。测试案例确保合约的功能按预期工作。

### 测试用例

测试套件包括以下测试用例:

1. **应正确 mint`Star`token**:

   - 验证只能由合约部署者 mint`Star`token。
   - 验证只能由合约部署者 mint`Star`token 给其他 user。
   - 验证其他 user 不能 mint`Star`token。

2. **应正确 burn`Star`token**:

   - 验证只能由合约部署者 burn`Star`token。
   - 验证合约部署者可以 burn 其他用户的`Star`token。
   - 验证不能由未授权的用户 burn `Star`token。
   - 验证不能 burn 的 `Star`token 超出了余额。

## Universe 合约测试

`Universe.mjs`包含了 `Universe` 合约的测试用例。`Universe` 合约是一个用于储蓄中`Star`这个 token 的智能合约。

### 目录

- [概述]
- [测试用例]

### 概述

`Universe` 合约负责储蓄账户的`Star`（自定义的 ERC-20 代币）的存入、取出和转移。测试案例确保合约的功能按预期工作。

### 测试用例

测试套件包括以下测试用例:

1. **应正确存入和取出`Star`**:

   - 验证用户可以在 `Universe` 合约中存储（`deposit`）和取出（`withdraw`）星星。
   - 检查合约中的用户地址对应的`Star`和合约中总的`totalStars`是否正确更新。

2. **应正确转移`Star`**:

   - 验证用户可以在不同账户之间转移`Star`。
   - 检查发送者和接收者的`Star`余额是否正确更新。

3. **应正确存储和取出储蓄金**:
   - 验证合约所有者可以向合约存储储蓄金。
   - 检查所有者是否可以将储蓄金从合约移动到指定用户账户。

## Sun 合约测试

`Sun.mjs`包含了 `Sun` 合约的测试用例。`Sun` 合约是一个用于储蓄中`Star`这个 token 并获利的智能合约。

### 目录

- [概述]
- [测试用例]

### 概述

`Sun` 合约负责储蓄账户的`Star`（自定义的 ERC-20 代币）的储蓄、获利、取出储蓄金。测试案例确保合约的功能按预期工作。

### 测试用例

测试套件包括以下测试用例:

1. **应该成功部署合约**:

   - 检查 Sun Contract 是否成功部署,且地址不为零地址。
   - 检查合约所有者是否被设置为授权用户。
   - 检查授权用户是否可以将其他地址添加或从授权用户列表中移除。

2. **应该正确计算和转移存款奖励**:

   - 检查用户在一年后的奖励是否计算正确,以及用户在 Universe Contract 中的余额是否相应更新。
   - 检查用户是否可以从 Sun Contract 中提取他们的存款代币,以及他们在 Universe Contract 中的余额是否正确更新。

3. **应正确更改 ssr**:
   - 测试 file 函数,该函数允许授权用户更新 ssr 参数.
   - 检查如果 file 函数由未授权用户调用,是否会回滚.
   - 检查如果提供了不被识别的参数,file 函数是否会回滚.
